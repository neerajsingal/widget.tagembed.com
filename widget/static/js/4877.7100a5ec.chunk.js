"use strict";(self.webpackChunkembed_widget=self.webpackChunkembed_widget||[]).push([[4877],{64877:(t,e,a)=>{a.r(e),a.d(e,{default:()=>U});var r=a(9950),o=a(73878),i=a(14478),s=a(89379),n=a(52867),d=a(66345),l=a(83744),c=a(80415),p=a(44414);function u(t){t.style.setProperty("visibility","visible","important"),t.style.setProperty("opacity","1","important"),t.style.setProperty("display","flex","important"),t.style.setProperty("transform","none","important"),t.style.setProperty("clip-path","initial","important"),t.style.setProperty("border","none","important")}class h extends r.PureComponent{render(){return(0,p.jsx)("a",{href:c.om,target:"_blank",ref:t=>{t&&(t.style.setProperty("margin-right","15px","important"),t.style.setProperty("width","90px","important"),t.style.setProperty("height","auto","important"),u(t))},children:(0,p.jsx)("img",{ref:t=>{t&&(t.style.setProperty("width","100%","important"),t.style.setProperty("height","auto","important"),u(t))},src:"".concat(c.th,"/media/images/").concat("tagshop-branding.svg")})})}}r.Component;r.Component;var m=a(60895),g=a(72076);const _=t=>{let{product:e,wall:a,onsetProductImg:o,openAddtocart:n,item:d,setOnProductDetails:c}=t;const[u,h]=(0,r.useState)(!1),[m,g]=(0,r.useState)(!1),_=(a.User.id,a.ProductSetting.Button),P=(t,e)=>{var a;return(0,i.hq)({type:1,action:2,wall:null===t||void 0===t||null===(a=t.Wall)||void 0===a?void 0:a.id,product_id:e.id,post:d.referenceId,owner:t.Wall.owner,feed:d.feedId,currency:e.price_currency,price:e.product_discount>0?e.product_discount:e.product_price})},w=t=>{const{Button:e}=a.ProductSetting;var r=t;2==parseInt(e.newTab)?window.parent.location.href=r:window.open(r,"_blank")},v=e.UgcProduct;return(0,p.jsxs)("div",{className:"tb_rpp_pro ".concat(u?"ts_reelTheme_No_Product":""),children:[u?null:(0,p.jsx)("div",{className:"tb_rpp_pro_img",children:(0,p.jsx)("img",{src:v.product_image,alt:"",onError:()=>h(!0)})}),(0,p.jsxs)("div",{className:"tb_rpp_pro_cont",children:[(0,p.jsx)("div",{className:"tb_rpp_pro_title",children:v.product_title}),v.product_price>0||v.product_discount>0?(0,p.jsxs)("div",{className:"tb_rpp_p_wrap",children:[(0,p.jsxs)("div",{className:"tb_rpp_p",children:[v.price_currency_symbol,v.product_discount>0?v.product_discount:v.product_price]}),0==v.product_discount||v.product_price==v.product_discount?(0,p.jsx)(p.Fragment,{}):(0,p.jsxs)("div",{className:"tb_rpp_p tb_rpp_d_p",children:[v.price_currency_symbol,v.product_price]})]}):null,(0,p.jsxs)("div",{className:"tb_rpp_btn".concat(m?" tb_rpp_btn_spinner":""),disabled:m,onClick:()=>{(async()=>{g(!0);const t={};if(e&&e.UgcProduct&&e.UgcProduct.product_url)try{var r,i,d;if(140717==(null===a||void 0===a||null===(r=a.Wall)||void 0===r?void 0:r.owner)||1==(null===a||void 0===a||null===(i=a.ProductSetting)||void 0===i||null===(d=i.Button)||void 0===d?void 0:d.pdp_target))w(e.UgcProduct.product_url),o(e.product_image),g(!1),P(a,e.UgcProduct);else{const r="magento"==e.UgcProduct.created_from||!1;""!=e.UgcProduct.created_from?(0,l.YS)(e.UgcProduct.product_url,r,{productId:e.UgcProduct.product_sku,storeId:e.UgcProduct.shopify_shop_id}).then((i=>{var d;if(r&&0==i.status){var l;t[e.id]={data:{available:!0},showCart:140717!==(null===a||void 0===a||null===(l=a.Wall)||void 0===l?void 0:l.owner)}}else{var p,u;const o=r&&(null===i||void 0===i||null===(p=i.data)||void 0===p?void 0:p.data)||(null===i||void 0===i?void 0:i.data),n=r?{available:!0}:{};t[e.id]={data:null!==o&&void 0!==o&&o.id?(0,s.A)((0,s.A)({},o),n):null,showCart:(null===o||void 0===o?void 0:o.id)&&140717!==(null===a||void 0===a||null===(u=a.Wall)||void 0===u?void 0:u.owner)}}o(null!==i&&void 0!==i&&null!==(d=i.data)&&void 0!==d&&d.featured_image?i.data.featured_image:e.product_image),g(!1),c(t),n(e.id,e)})).catch((t=>{console.log("error",t),w(e.UgcProduct.product_url),o(e.product_image),g(!1),P(a,e.UgcProduct)})):(w(e.UgcProduct.product_url),o(e.product_image),g(!1),P(a,e.UgcProduct))}}catch(p){console.log("error",p),w(e.UgcProduct.product_url),g(!1)}})()},children:[_.text," "]})]})]})},P=(0,r.memo)(_),w=r.lazy((()=>Promise.all([a.e(1823),a.e(8262)]).then(a.bind(a,78262)))),v=r.lazy((()=>Promise.all([a.e(8092),a.e(426)]).then(a.bind(a,80426)))),D=r.lazy((()=>a.e(4116).then(a.bind(a,34116)))),x=t=>{const{itemData:e,wallID:a,ownerId:o,wall:i,muted:n,autoPlay:d,index:l}=t,c=!1;return(0,p.jsx)("div",{className:"tb_rp_media_wrap",role:"button",tabIndex:"0","aria-label":"Pop Up Button",children:e.imageList&&e.imageList.length>0?(0,p.jsx)(r.Suspense,{fallback:(0,p.jsx)(p.Fragment,{}),children:(0,p.jsx)(D,(0,s.A)({imageList:e.imageList},t))}):2!==e.type&&4!==e.type&&d?3===e.type||5===e.type?(0,p.jsx)(r.Suspense,{fallback:(0,p.jsx)(p.Fragment,{}),children:(0,p.jsx)(v,{VideoClass:"tb_rp_video",data:(0,s.A)((0,s.A)({},e),{},{postFileNew:e.filename}),wallID:a,themeID:i.Personalization.widgetTheme,ownerId:o,size:c,isCover:!0,controls:!1,autoPlay:d,muted:n,handleVideoEnded:()=>{},index:l})}):null:(0,p.jsx)(r.Suspense,{fallback:(0,p.jsx)(p.Fragment,{}),children:(0,p.jsx)(w,{ImageClass:"tb_rp_image",data:(0,s.A)((0,s.A)({},e),{},{postFileNew:e.filename}),wallID:a,themeID:i.Personalization.widgetTheme,ownerId:o,size:c,ThemeRule:i.ThemeRule})})})},S=(0,r.memo)(x);var y=a(68940);a(99425);const I=t=>{let{wall:e,item:a,personalization:r,productLoading:o,showAddToCart:i,onsetProductImg:s,openAddtocart:n,setOnProductDetails:d,isFreePlan:l,index:c,currentVideo:u,muteToggle:m,muted:g}=t;const _=a.ugc_products,w=!(3!==a.type&&5!==a.type||!u);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(S,{itemData:a,wallID:e.Wall.wallId,ownerId:e.Wall.owner,ThemeID:r.widgetTheme,wall:e,muted:g,autoPlay:w,index:c}),(0,p.jsxs)("div",{className:"tb_rp_content",children:[e.ProductSetting&&1==r.themeType&&_&&_.length>0?(0,p.jsx)(y.RC,{autoHeight:!0,speed:400,edgeSwipeDetection:!0,slidesPerView:a.ugc_products&&a.ugc_products.length>1?1.3:1,touchRatio:2,spaceBetween:0,mousewheel:{forceToAxis:!0,sensitivity:2},watchSlidesProgress:!0,direction:"horizontal",className:"tb_rpp_wrap",children:a.ugc_products&&a.ugc_products.map(((t,r)=>(0,p.jsx)(y.qr,{children:(0,p.jsx)(P,{product:t,openAddtocart:n,onsetProductImg:s,showAddToCart:i,productLoading:o,wall:e,ugcSetting:e.ProductSetting,item:a,setOnProductDetails:d})},r)))}):null,w?(0,p.jsx)("div",{className:"tb_rp_mute_btn",onClick:m,children:(0,p.jsx)("div",{className:"tb__icon tb-".concat(g?"mute":"unmute"),children:(0,p.jsx)("div",{})})}):null,e.UserRule.branding_lite&&1==e.UserRule.branding_lite||l?(0,p.jsx)(h,{wallId:e.Wall.id,themeID:e.Personalization.widgetTheme}):null]})]})},b=(0,r.memo)(I);(0,a(79175).kz)();class C extends r.Component{constructor(t){var e;super(t),this.setMuted=t=>this.setState({muted:!this.state.muted}),this.setOnProductDetails=t=>this.setState({allProductDetails:t}),this.onErrorVideo=t=>this.setState({isVideoError:!0}),this.onMediaUpdate=t=>this.setState({isAuthorImagevalid:!1}),this.onAddToCart=(t,e,a)=>{const{wall:r}=this.props;setTimeout((()=>{this.setState({addCartSetTime:!0})}),100);const o={type:1,action:2,wall:r.Wall.id,feed:a.feedId,post:a.referenceId?a.referenceId:a.id,owner:r.Wall.owner,product_id:e.UgcProduct.id,currency:e.UgcProduct.price_currency,price:e.UgcProduct.product_discount>0?e.UgcProduct.product_discount:e.UgcProduct.product_price};this.setState({addtoCartPopup:!0,selectedProductDetails:this.state.allProductDetails[t],tagshopProductDeatil:(0,s.A)((0,s.A)({},e),{},{trackingData:o})})},this.requestData=()=>{const{wall:t,appendData:e,hasMoreData:a,loaderData:r}=this.props,o=t.ThemeRule.numberOfPosts,i=Math.floor(Date.now()/1e3);a&&!r.isShowMoreLoading&&this.props.getDataNextSteps(t.Wall.id,i,o,e.networkID,e.after,e.heightEvent)},this.onItemChange=t=>this.setState({item:t}),this.currentSwiperSlide=t=>{this.props.hasMoreData&&t.progress>.9&&this.requestData(),this.onPopUpTrack(t.activeIndex)},this.onPopUpTrack=t=>{try{const{wall:e,completeData:a}=this.props;let r=a[t]?a[t]:null;if(r){const t={feed:r.feedId,post:r.referenceId?r.referenceId:r.id},a={wallId:e.Wall.id,userId:e.Wall.owner,feedId:r.feedId,postId:r.id},o={action:2,wall:e.Wall.id,feed:r.feedId,post:r.referenceId?r.referenceId:r.id,type:3,owner:e.Wall.owner};(0,i.hq)(d.uS?a:d.Qy?o:(0,s.A)((0,s.A)({action:2,wall:e.Wall.id},t),{},{owner:e.Wall.owner}))}}catch(e){console.log("Error in PopUp Tracking",e)}},this.startSwiperSlide=t=>{this.setState({activeSlide:t.activeIndex})},this.onClickClosePopUp=t=>this.setState({addtoCartPopup:!1,continueShopping:!1,selectedProductDetails:null,addCartSetTime:!1}),this.onClickCheckOut=t=>this.setState({addtoCartPopup:!0,continueShopping:!1}),this.sliderRef=r.createRef(),this.state={currentIndex:null===(e=this.props)||void 0===e?void 0:e.currentIndex,item:this.props.item,isVideoError:!1,windowWidth:window.innerWidth,isAuthorImagevalid:!0,instaImg:(0,n.kR)(this.props.imgData,this.props.item.link),isHotspot:!1,addtoCartPopup:!1,allProductDetails:null,selectedProductId:null,selectedProductDetails:null,continueShopping:!1,selectedVariant:null,showAddToCart:!1,productLoading:!0,productImg:"",tagshopProductDeatil:null,muted:!1,activeSlide:0,addCartSetTime:!1,selectedProdDetails:null,tagProdDetail:null},this.splideRef=r.createRef()}componentDidMount(){const{currentIndex:t,item:e}=this.props,a=(0,n.hz)(e.author.picture);this.setState({currentIndex:t,item:e,isAuthorImagevalid:a,instaImg:(0,n.kR)(this.props.imgData,this.props.item.link)}),this.splideRef.current.addEventListener("swiperslidechange",(t=>{this.props.hasMoreData&&t.detail[0].progress>.9&&(this.requestData(),this.setState({currentIndex:this.splideRef.current.swiper.activeIndex}))}))}componentWillReceiveProps(t){const{currentIndex:e,item:a}=t,r=(0,n.hz)(a.author.picture);this.setState({currentIndex:e,item:a,isVideoError:!1,isAuthorImagevalid:r,instaImg:(0,n.kR)(this.props.imgData,this.props.item.link)})}render(){var t;const{personalization:e,onClosePopUp:a,slideWithArrowKeys:r,wall:o,webFilters:i,completeData:s,isFreePlan:n}=this.props,{currentIndex:d,item:l,isVideoError:c,instaImg:u,addtoCartPopup:h,selectedProductDetails:_,continueShopping:P,selectedVariant:w,showAddToCart:v,productImg:D,productLoading:x,tagshopProductDeatil:S,activeSlide:I,addCartSetTime:C,muted:f,selectedProdDetails:j,tagProdDetail:U}=this.state;return(0,p.jsxs)("div",{className:"modalId".concat(l.id," tb_rp_modal ").concat(C?"tb_rp_add_cart_m":""),onKeyDown:r,onKeyPress:r,onLoad:r,onClick:t=>t.currentTarget==t.target&&a(t),children:[(0,p.jsxs)("div",{className:"tb_rp_dialog",children:[h||P?null:(0,p.jsx)("div",{className:"tb_reel_close_btn",onClick:a,children:(0,p.jsx)("div",{className:"tb__icon tb-close-thin",children:(0,p.jsx)("div",{})})}),(0,p.jsx)("div",{className:"tb_time_line_wrap",children:(0,p.jsx)("div",{className:"tb_time_line",children:(0,p.jsx)("div",{})})}),(0,p.jsx)(y.RC,{ref:this.splideRef,direction:"vertical",touchRatio:2,freeMode:JSON.stringify({enabled:!0,sticky:!0}),height:"".concat(window.innerHeight),initialSlide:d,passiveListeners:!0,mousewheel:{forceToAxis:!0,sensitivity:2},watchSlidesProgress:!0,onSlideChange:t=>this.currentSwiperSlide(t),children:s&&s.length>0?s.map(((t,r)=>(0,p.jsx)(y.qr,{children:i=>{let{isActive:s}=i;return(0,p.jsx)(b,{currentVideo:s,onClosePopUp:a,wall:o,item:t,instaImg:u,showAddToCart:v,openAddtocart:(e,a)=>this.onAddToCart(e,a,t),onsetProductImg:t=>this.setState({productImg:t}),productLoading:x,sliderRef:this.sliderRef,personalization:e,isVideoError:c,addtoCartPopup:h,continueShopping:P,setOnProductDetails:this.setOnProductDetails,isFreePlan:n,muteToggle:this.setMuted,muted:f},"".concat(t.id,"-").concat(r))}},"".concat(t.id,"-").concat(r)))):(0,p.jsx)(p.Fragment,{})})]}),h&&_?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"tb_rp_cart_overlay",children:(0,p.jsx)("div",{})}),(0,p.jsx)("div",{className:"tb_rp_cart_modal",children:(0,p.jsxs)("div",{className:"tb_rp_cart_body",children:[(0,p.jsx)("div",{className:"ts_reel_close_btn tb_reel_close_btn",onClick:h&&!P?this.onClickClosePopUp:P?t=>this.setState({addtoCartPopup:!0,continueShopping:!1}):null,children:(0,p.jsx)("div",{className:"tb__icon tb-close-thin",children:(0,p.jsx)("div",{})})}),(0,p.jsx)("div",{className:"tb_rp_cart_wrap",children:_&&Object.keys(_).length>0?"magento"==(null===S||void 0===S||null===(t=S.UgcProduct)||void 0===t?void 0:t.created_from)?(0,p.jsx)(m.A,{productImg:D,addtoCartPopup:h,productDetails:_,tagshopProductDeatil:S,closeCart:t=>this.setState({addtoCartPopup:!1,continueShopping:!1,selectedProductDetails:null}),onAddToCart:()=>this.setState({continueShopping:!0}),onSelectedVariant:t=>this.setState({selectedVariant:t}),wall:o,closePopUp:this.props.onClosePopUp}):(0,p.jsx)(g.A,{productImg:D,addtoCartPopup:h,productDetails:_,tagshopProductDeatil:S,closeCart:t=>this.setState({addtoCartPopup:!1,continueShopping:!1,selectedProductDetails:null}),onAddToCart:()=>this.setState({continueShopping:!0}),onSelectedVariant:t=>this.setState({selectedVariant:t}),wall:o,closePopUp:this.props.onClosePopUp}):null})]})})]}):null]})}}const f=(0,o.Ng)((t=>{const{appData:e}=t;return{loaderData:t.loaderData,appendData:e.postData.appendData,hasMoreData:!e.postData.hasMoreData[0]||0!=e.postData.hasMoreData[0].hasMoreData&&(!e.postData.hasMoreData[e.postData.appendData.networkID]||e.postData.hasMoreData[e.postData.appendData.networkID].hasMoreData)}}),(t=>({getDataNextSteps:(e,a,r,o,s,n,d)=>t((0,i.H5)(e,a,r,o,s,n,d))})))((0,r.memo)(C));class j extends r.PureComponent{constructor(){super(...arguments),this.state={isEnable:0,eventData:{},shareText:"SHARE",viewOnText:"View on",currentIndex:null,completeData:{},personalization:{},url:null,imgData:[]},this.closeCommercePopUP=t=>{this.setState({isEnable:0,currentIndex:null},(()=>this.props.closePopUP()));var e=document.getElementsByTagName("html");e&&e[0]&&(e[0].style.overflow="")},this.getCommercePopUPEvent=t=>{void 0!==t&&""!==t&&t.card&&this.setState({url:"",isEnable:1,eventData:t,currentIndex:t.index,completeData:t.idArray,viewOnText:t.viewOnText,shareText:t.shareText,windowParent:t,imgData:t.imgData,personalization:t.personalization},(()=>this.CommercePopUPSlideWithArrowKey()))},this.featuredPopSliderChangeIndex=t=>e=>{const{eventData:a}=this.state;-1===t?this.setState({currentIndex:a.idArray.length-1}):this.setState({currentIndex:a.idArray.length===t?0:t})},this.SliderWithKey=t=>{const{eventData:e}=this.state;-1===t?this.setState({currentIndex:e.idArray.length-1}):this.setState({currentIndex:e.idArray.length===t?0:t})},this.CommercePopUPSlideWithArrowKey=t=>{const{personalization:e}=this.state;if(e&&1===e.popupSlideShow){let e=this;(t=t||window.event)&&t.keyCode&&void 0!==t.keyCode&&(37===t.keyCode?e.SliderWithKey(e.state.currentIndex-1):39===t.keyCode?e.SliderWithKey(e.state.currentIndex+1):27===t.keyCode&&this.closeCommercePopUP())}}}componentDidMount(){const{data:t}=this.props;this.getCommercePopUPEvent(t);var e=document.getElementsByTagName("html");e&&e[0]&&(e[0].style.overflow="hidden")}componentDidUpdate(t){this.props.data!==t.data&&this.getCommercePopUPEvent(this.props.data)}componentWillReceiveProps(t){const{postData:e}=t;let{completeData:a,eventData:r}=this.state;if(a.length!=e.postData.length){let t=e.postData.map((t=>e.completeDataObject[t])).filter((t=>!String(t.id).includes("free_add_")));r.idArray=t,this.setState({completeData:t,eventData:r},(()=>{const{currentIndex:t}=this.state;this.setState({currentIndex:t+1})}))}else{!(e.hasMoreData&&Object.keys(e.hasMoreData).length>0)||(!e.hasMoreData[0]||0!=e.hasMoreData[0].hasMoreData)&&(!e.hasMoreData[e.appendData.networkID]||e.hasMoreData[e.appendData.networkID].hasMoreData)}}render(){const{viewOnText:t,isEnable:e,currentIndex:a,personalization:r,completeData:o,eventData:i,url:s,imgData:n}=this.state,{postData:d}=this.props;let l=null;l=-1===a?o[i.idArray.length-1]:o[a];const{wall:c,webFilters:u}=this.props;return 1===e&&c&&o&&Object(o).length>0?(0,p.jsx)(f,{webFilters:u,wall:c,item:l,completeData:o,onClosePopUp:this.closeCommercePopUP,currentIndex:a,personalization:r,viewOnText:t,slideWithArrowKeys:this.CommercePopUPSlideWithArrowKey,featuredPopSliderChangeIndex:this.featuredPopSliderChangeIndex,hostUrl:s,imgData:n,isFreePlan:d&&d.isFreeAdsStatus}):null}}const U=(0,o.Ng)((t=>({wall:t.appData.wall,webFilters:t.appData.webFilters})),(t=>({closePopUP:e=>t((0,i.ng)(e))})))(j)}}]);